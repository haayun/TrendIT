import pymysql

def excute_select(conn, sql, data) :
    conn = pymysql.connect(
        user="trendit",
        passwd="trendit829",
        host="localhost",
        db="trendit",
        charset='utf8'
    )
    cursor = conn.cursor()
    cursor.execute(sql, data)
    result = cursor.fetchall()
    cursor.close()
    conn.close()
    return result

def excute_insert_many(conn, sql, data) :
    conn = pymysql.connect(
        user="trendit",
        passwd="trendit829",
        host="localhost",
        db="trendit",
        charset='utf8'
    )
    cursor = conn.cursor()
    cursor.executemany(sql, data)
    cursor.close()
    conn.close()

# usage
# data = [(headline, img_link, news_agency, news_content, news_date, news_link),
#         (headline, img_link, news_agency, news_content, news_date, news_link),
#         (headline, img_link, news_agency, news_content, news_date, news_link)]
def insert_news(data) :
    sql = """INSERT INTO `news`(headline, img_link, news_agency, news_content, news_date, news_link) VALUES (%s, %s, %s, %s, %s, %s);"""
    excute_insert_many(sql, data)
    
# usage
# date = "2022-01-01"
def select_news(date) :
    sql = """SELECT headline, id from `news`(headline, img_link, news_agency, news_content, news_date, news_link) VALUES (%s, %s, %s, %s, %s, %s);"""
    excute_select(sql, date)

# usage
# data = [(keyword_id, news_id),
#         (keyword_id, news_id),
#         (keyword_id, news_id)]
def insert_keyword_has_news(data) :
    sql = """INSERT INTO `keyword_has_news`(keyword_id, news_id) VALUES (%s, %s);"""
    excute_insert_many(sql, data)